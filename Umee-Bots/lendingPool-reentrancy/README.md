# Detect Reentrancy In Lending Pool

## Description

Detects reentrancy inside LendingProtocol smart contract. If the call is a reentrant call function inside the `FUNCTIONS_SELECTORS` array.

## Supported Chains

- Ethereum

## Alerts

- UMEE-9
  - Fired when in a transaction occur multiple nested calls to the same contract (reentrancy)
  - Severity is always set to "High."
  - Type is always set to "Exploit."
  - Metadata contains:
    - initialCallSelector: The selector of the function that calls the `LendingPool` smart contract
    - lendingPoolCallSelector: The selector of the first reentrancy case on the `LendingPool` smart contract

## Test Data

### Kovan Testnet (PoC)

The following test was generated by interacting with PoC contracts (available at the `PoC/` directory) deployed on the Kovan testnet.

To check the results, uncomment the lines indicated in `src/agent.config.ts`, use a paid API node version to fetch the `traces` on Kovan testnet RPC (e.g. `https://eth-kovan.alchemyapi.io/v2/<Your-Key>`) as `jsonRpcUrl` in your `forta.config.json` file and run:

```
npm run block 31800952
```

In the block `31800952`, `ReentrantCaller.attack(contractAddress)` is executed. It will create a reentrant call on the `withdraw` transaction and a finding will be emitted.
