# Detect Reentrancy In Lending Pool

## Description

Detects reentrancy inside LendingProtocol smart contract. If the call is a reentrant call function inside the `reentrancyBlacklist` array.

## Supported Chains

- Ethereum

## Alerts

- UMEE-9
  - Fired when in a transaction occur multiple nested calls to the same contract (reentrancy)
  - Severity is always set to "High."
  - Type is always set to "Exploit."
  - Metadata contains:
    - initialCallSelector: The selector of the function that calls the `LendingPool` smart contract
    - lendingPoolCallSelector: The selector of the first reentrancy case on the `LendingPool` smart contract

## Test Data

### Kovan Testnet (PoC)

The following test was generated by interacting with PoC contracts (available at the `PoC/` directory) deployed on the Kovan testnet.

To check the results, uncomment the lines indicated in `src/agent.config.ts`, use a Kovan testnet trace-enabled RPC endpoint (e.g. `https://eth-kovan.alchemyapi.io/v2/<Your-Key>`) as `jsonRpcUrl` and `traceRpcUrl` in your `forta.config.json` file and run:

```
npm run block 31913146
```

In the block `31913146`, `MockLendingPool.test()` is executed. It will perform a reentrant call to `withdraw()` on `deposit()` and, because of that, a finding will be emitted.
